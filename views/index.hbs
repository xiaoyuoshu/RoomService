<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <title>公用房预约</title>
    <meta name="renderer" content="webkit">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
    <link rel="stylesheet" href="../layui/css/layui.css"  media="all">
    <link rel="stylesheet" href="../stylesheets/index.css"  media="all">
    <script>
        document.title = '公用房预约 | 使用情况'
    </script>
    <script src="../layui/layui.js"></script>
    <script src="/javascripts/jquery-3.1.1.min.js"></script>
</head>

<body class="layui-layout-body" style="background: #EBEDF4">
    <!-- 让IE8/9支持媒体查询，从而兼容栅格 -->
    <!--[if lt IE 9]>
    <script src="https://cdn.staticfile.org/html5shiv/r29/html5.min.js"></script>
    <script src="https://cdn.staticfile.org/respond.js/1.4.2/respond.min.js"></script>
    <![endif]-->

    <div class="layui-layout layui-layout-admin">
        <!-- 头部导航栏 -->
        <div class="layui-header">
            <div class="layui-logo" style="font-size: 40px;padding-left: 50px;width: auto;color: gainsboro">电信学院-公用房预约</div>
            <!-- 头部区域（可配合layui已有的水平导航） -->
            <ul class="layui-nav layui-layout-left" style="padding-left: 250px">
                <li class="layui-nav-item"><a href="/">使用情况</a></li>
                <li class="layui-nav-item"><a href="/form">开始预约</a></li>
                <li class="layui-nav-item"><a href="/tips">使用说明</a></li>
            </ul>
        </div>


        <!-- 主体内容 -->
        <div class="layui-body" style="left: 0">
            <script>
                function GetWeek(a) {
                    if (a == 1){
                        return "周一"
                    }else if (a == 2){
                        return "周二"
                    }else if (a == 3){
                        return "周三"
                    }else if (a == 4){
                        return "周四"
                    }else if (a == 5){
                        return "周五"
                    }else if (a == 6){
                        return "周六"
                    }else if (a == 0){
                        return "周日"
                    }
                    else {
                        return "未知"
                    }
                }
            </script>
            <div class="layui-row">
                <div class="layui-col-md8 layui-col-md-offset2">
                    <table class="layui-table" lay-size="lg" style="margin-top: 50px">
                        <colgroup>
                            <col width="220">
                            <col width="180">
                            <col width="180">
                            <col width="180">
                            <col>
                        </colgroup>
                        <thead>
                        <tr>
                            <th>申请人</th>
                            <th>用途</th>
                            <th>日期</th>
                            <th>时间</th>
                            <th>负责人</th>
                            <th>状态</th>
                        </tr>
                        </thead>
                        <tbody>
                        {{#each Occupied}}
                            <tr id="{{init_time}}">
                                <script>
                                    var dom = $('#{{init_time}}');
                                    dom.append('<td style="color:red">临时占用</td>');
                                    dom.append('<td style="color:red">临时占用</td>');
                                    var begin_date = new Date({{begin_time}});
                                    var end_date = new Date({{end_time}});
                                    var date = (begin_date.getMonth()+1)
                                            + "月"
                                            +(begin_date.getDate()<10?('0'+begin_date.getDate()):(begin_date.getDate()))
                                            +"日（"
                                            +GetWeek(begin_date.getDay())
                                            +"）";
                                    dom.append('<td style="color:red">'+date+'</td>');
                                    var time = begin_date.getHours()
                                            +':'
                                            +(begin_date.getMinutes()<10?('0'+begin_date.getMinutes()):(begin_date.getMinutes()))
                                            +'~'+end_date.getHours()
                                            +':'
                                            +(end_date.getMinutes()<10?('0'+end_date.getMinutes()):(end_date.getMinutes()));
                                    dom.append('<td style="color:red">'+time+'</td>');
                                    dom.append('<td style="color:red">临时占用</td>');
                                    dom.append('<td style="color:red">临时占用</td>');
                                </script>
                            </tr>
                        {{/each}}
                        {{#each ing}}
                            <tr id="{{init_time}}">
                                <script>
                                    var dom = $('#{{init_time}}');
                                    dom.append('<td>{{applicant}}({{department}})</td>');
                                    dom.append('<td>{{reason}}</td>');
                                    var begin_date = new Date({{begin_time}});
                                    var end_date = new Date({{end_time}});
                                    var date = (begin_date.getMonth()+1)
                                            + "月"
                                            +(begin_date.getDate()<10?('0'+begin_date.getDate()):(begin_date.getDate()))
                                            +"日（"
                                            +GetWeek(begin_date.getDay())
                                            +"）";
                                    dom.append('<td>'+date+'</td>');
                                    var time = begin_date.getHours()
                                            +':'
                                            +(begin_date.getMinutes()<10?('0'+begin_date.getMinutes()):(begin_date.getMinutes()))
                                            +'~'+end_date.getHours()
                                            +':'
                                            +(end_date.getMinutes()<10?('0'+end_date.getMinutes()):(end_date.getMinutes()));
                                    dom.append('<td>'+time+'</td>');
                                    dom.append('<td>{{principle}}</td>');
                                    dom.append('<td>正在进行</td>');
                                </script>
                            </tr>
                        {{/each}}
                        {{#each success}}
                            <tr id="{{init_time}}">
                                <script>
                                    var dom = $('#{{init_time}}');
                                    dom.append('<td>{{applicant}}({{department}})</td>');
                                    dom.append('<td>{{reason}}</td>');
                                    var begin_date = new Date({{begin_time}});
                                    var end_date = new Date({{end_time}});
                                    var date = (begin_date.getMonth()+1)
                                            + "月"
                                            +(begin_date.getDate()<10?('0'+begin_date.getDate()):(begin_date.getDate()))
                                            +"日（"
                                            +GetWeek(begin_date.getDay())
                                            +"）";
                                    dom.append('<td>'+date+'</td>');
                                    var time = begin_date.getHours()
                                            +':'
                                            +(begin_date.getMinutes()<10?('0'+begin_date.getMinutes()):(begin_date.getMinutes()))
                                            +'~'+end_date.getHours()
                                            +':'
                                            +(end_date.getMinutes()<10?('0'+end_date.getMinutes()):(end_date.getMinutes()));
                                    dom.append('<td>'+time+'</td>');
                                    dom.append('<td>{{principle}}</td>');
                                    dom.append('<td>审核成功</td>');
                                </script>
                            </tr>
                        {{/each}}
                        {{#each waiting}}
                            <tr id="{{init_time}}">
                                <script>
                                    var dom = $('#{{init_time}}');
                                    dom.append('<td>{{applicant}}({{department}})</td>');
                                    dom.append('<td>{{reason}}</td>');
                                    var begin_date = new Date({{begin_time}});
                                    var end_date = new Date({{end_time}});
                                    var date = (begin_date.getMonth()+1)
                                            + "月"
                                            +(begin_date.getDate()<10?('0'+begin_date.getDate()):(begin_date.getDate()))
                                            +"日（"
                                            +GetWeek(begin_date.getDay())
                                            +"）";
                                    dom.append('<td>'+date+'</td>');
                                    var time = begin_date.getHours()
                                            +':'
                                            +(begin_date.getMinutes()<10?('0'+begin_date.getMinutes()):(begin_date.getMinutes()))
                                            +'~'+end_date.getHours()
                                            +':'
                                            +(end_date.getMinutes()<10?('0'+end_date.getMinutes()):(end_date.getMinutes()));
                                    dom.append('<td>'+time+'</td>');
                                    dom.append('<td>{{principle}}</td>');
                                    dom.append('<td>等待审核</td>');
                                </script>
                            </tr>
                        {{/each}}
                        {{#each isFinished}}
                            <tr id="{{init_time}}">
                                <script>
                                    var dom = $('#{{init_time}}');
                                    dom.append('<td>{{applicant}}({{department}})</td>');
                                    dom.append('<td>{{reason}}</td>');
                                    var begin_date = new Date({{begin_time}});
                                    var end_date = new Date({{end_time}});
                                    var date = (begin_date.getMonth()+1)
                                            + "月"
                                            +(begin_date.getDate()<10?('0'+begin_date.getDate()):(begin_date.getDate()))
                                            +"日（"
                                            +GetWeek(begin_date.getDay())
                                            +"）";
                                    dom.append('<td>'+date+'</td>');
                                    var time = begin_date.getHours()
                                            +':'
                                            +(begin_date.getMinutes()<10?('0'+begin_date.getMinutes()):(begin_date.getMinutes()))
                                            +'~'+end_date.getHours()
                                            +':'
                                            +(end_date.getMinutes()<10?('0'+end_date.getMinutes()):(end_date.getMinutes()));
                                    dom.append('<td>'+time+'</td>');
                                    dom.append('<td>{{principle}}</td>');
                                    dom.append('<td>已结束</td>');
                                </script>
                            </tr>
                        {{/each}}
                        </tbody>
                    </table>
                </div>
            </div>
        </div>

        <!-- 底部信息栏 -->
        <div class="layui-footer" style="left:0;text-align: center">
            © 电信学院 - 科协技术部&办公室 | E-mail：xiaoyuo@hust.edu.cn
        </div>
    </div>

    <!-- js脚本部分 -->
    <script>
        //JavaScript代码区域
        function GetWeek(a) {
            if (a == 1){
                return "周一"
            }else if (a == 2){
                return "周二"
            }else if (a == 3){
                return "周三"
            }else if (a == 4){
                return "周四"
            }else if (a == 5){
                return "周五"
            }else if (a == 6){
                return "周六"
            }else if (a == 0){
                return "周日"
            }
            else {
                return "未知"
            }
        }
        /**
         * element:导航栏
         * layer:弹出层
         */
        layui.use(['element','layer'], function(){
            var element = layui.element;
            var layer = layui.layer;
            layer.open({
                type: 1
                ,title: false //不显示标题栏
                ,closeBtn: false
                ,area: '300px;'
                ,shade: 0.8
                ,id: 'LAY_layuipro' //设定一个id，防止重复弹出
                ,btn: ['查看记录','立即预约']
                ,btnAlign: 'c'
                ,moveType: 1
                ,content: '<div style="padding: 30px; line-height: 22px; background-color: #393D49; color: #fff; font-weight: 300;">' +
                '<p style="text-align: center">【公用房使用规范】</p>' +
                '<p style="text-indent: 30px">会议室租用者有责任保持会议室卫生与物品摆放整洁；</p>' +
                '<p style="text-indent: 30px">任何人禁止在未经允许情况下使用公用房物品；</p>' +
                '<p style="text-indent: 30px">会议室使用结束后，关闭门窗、切断使用电源并将凳子摆放归位；</p>' +
                '<br><p style="text-align: center">【常规事项】</p>' +
                '<p style="text-indent: 30px">除分团委学生会部门、院系各队伍之外的申请人请联系办公室负责人：玉米提（QQ 859721390）说明具体申请原因并获取开门方式；</p>' +
                '<p style="text-indent: 30px">会议室申请应在使用前12小时完成；</p>' +
                '<p style="text-indent: 30px">会议室可能存在临时占用情况；</p>' +
                '<p style="text-indent: 30px;color: red">若在使用过程中有违反公用房使用规范的情况，下次申请将不予审批；</p>' +
                '<br><p style="text-indent: 30px">更多指南见【使用说明】标签页</p>' +
                '</div>'
                ,success: function(layero){
                    var btn = layero.find('.layui-layer-btn');
                    btn.find('.layui-layer-btn1').attr({
                        href: '/form'
                    });
                }
            });
        });
    </script>

</body>